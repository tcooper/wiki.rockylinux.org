
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://wiki.rockylinux.org/archive/legacy/koji_setup/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.11">
    
    
      
        <title>Koji setup - Rocky Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8c5ef100.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.9647289d.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="teal">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Rocky Wiki" class="md-header__button md-logo" aria-label="Rocky Wiki" data-md-component="logo">
      
  <img src="../../../assets/icon-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Rocky Wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Koji setup
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/rocky-linux/wiki.rockylinux.org" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    rocky-linux/wiki.rockylinux.org
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Welcome
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../links/" class="md-tabs__link">
      Link Directory
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../irc/" class="md-tabs__link">
        IRC
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../guidelines/bug_tracker_guidelines/" class="md-tabs__link">
        Guidelines
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../special_interest_groups/" class="md-tabs__link">
        Special Interest Groups
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../team/" class="md-tabs__link">
        Teams
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../rocky/" class="md-tabs__link">
        Rocky Linux
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../" class="md-tabs__link md-tabs__link--active">
        Archive
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../contributing/" class="md-tabs__link">
        Contributing
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Rocky Wiki" class="md-nav__button md-logo" aria-label="Rocky Wiki" data-md-component="logo">
      
  <img src="../../../assets/icon-white.svg" alt="logo">

    </a>
    Rocky Wiki
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/rocky-linux/wiki.rockylinux.org" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    rocky-linux/wiki.rockylinux.org
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../links/" class="md-nav__link">
        Link Directory
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" data-md-state="indeterminate" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          IRC
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="IRC" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          IRC
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../irc/" class="md-nav__link">
        IRC General Information
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" data-md-state="indeterminate" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Guidelines
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Guidelines" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Guidelines
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../guidelines/bug_tracker_guidelines/" class="md-nav__link">
        Bug Tracker Guidelines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../guidelines/git_guidelines/" class="md-nav__link">
        Git Guidelines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../guidelines/maillist_guidelines/" class="md-nav__link">
        RESF Mailing List Guidelines
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" data-md-state="indeterminate" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Special Interest Groups
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Special Interest Groups" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Special Interest Groups
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../special_interest_groups/" class="md-nav__link">
        Special Interest Groups
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2" data-md-state="indeterminate" type="checkbox" id="__nav_5_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5_2">
          SIG Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="SIG Guide" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          SIG Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../special_interest_groups/sig_guide/" class="md-nav__link">
        SIG Guide Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../special_interest_groups/sig_guide/build/" class="md-nav__link">
        Building Packages
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../special_interest_groups/sig_guide/content/" class="md-nav__link">
        Managing Content
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../special_interest_groups/sig_guide/proposal/" class="md-nav__link">
        Proposing a SIG
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../special_interest_groups/sig_guide/release/" class="md-nav__link">
        Releasing Packages
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../special_interest_groups/sig_guide/testing/" class="md-nav__link">
        Automated Testing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" data-md-state="indeterminate" type="checkbox" id="__nav_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Teams
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Teams" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Teams
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/" class="md-nav__link">
        Teams
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_2" data-md-state="indeterminate" type="checkbox" id="__nav_6_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6_2">
          Infrastructure
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Infrastructure" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_2">
          <span class="md-nav__icon md-icon"></span>
          Infrastructure
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/infrastructure/awx_scm_guidelines/" class="md-nav__link">
        AWX SCM Guidelines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/infrastructure/idm_pdr/" class="md-nav__link">
        PDR Delete Request
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/infrastructure/idm_sop_gdpr/" class="md-nav__link">
        SOP: Personal Data Request - Deletion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/infrastructure/services/" class="md-nav__link">
        Services and Software
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_3" data-md-state="indeterminate" type="checkbox" id="__nav_6_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6_3">
          Release Engineering
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Release Engineering" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_3">
          <span class="md-nav__icon md-icon"></span>
          Release Engineering
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/release_engineering/" class="md-nav__link">
        Release Engineering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/release_engineering/packagekit/" class="md-nav__link">
        Package Kit
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_3_3" data-md-state="indeterminate" type="checkbox" id="__nav_6_3_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6_3_3">
          Debranding and Patching
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Debranding and Patching" data-md-level="3">
        <label class="md-nav__title" for="__nav_6_3_3">
          <span class="md-nav__icon md-icon"></span>
          Debranding and Patching
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/release_engineering/debranding/" class="md-nav__link">
        Intro to Debranding with Rocky Linux
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_3_4" data-md-state="indeterminate" type="checkbox" id="__nav_6_3_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6_3_4">
          rpm
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="rpm" data-md-level="3">
        <label class="md-nav__title" for="__nav_6_3_4">
          <span class="md-nav__icon md-icon"></span>
          rpm
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/release_engineering/rpm/" class="md-nav__link">
        RPM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/release_engineering/rpm/local_module_builds/" class="md-nav__link">
        Local Module Builds
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_3_5" data-md-state="indeterminate" type="checkbox" id="__nav_6_3_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6_3_5">
          guidelines
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="guidelines" data-md-level="3">
        <label class="md-nav__title" for="__nav_6_3_5">
          <span class="md-nav__icon md-icon"></span>
          guidelines
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/release_engineering/guidelines/" class="md-nav__link">
        Guidelines
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_3_6" data-md-state="indeterminate" type="checkbox" id="__nav_6_3_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6_3_6">
          legacy
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="legacy" data-md-level="3">
        <label class="md-nav__title" for="__nav_6_3_6">
          <span class="md-nav__icon md-icon"></span>
          legacy
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/release_engineering/legacy/debrand_list/" class="md-nav__link">
        Rocky Debrand Packages List
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/release_engineering/legacy/koji_tagging/" class="md-nav__link">
        Koji Tagging Strategy
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/release_engineering/sop_compose/" class="md-nav__link">
        SOP Compose
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_4" data-md-state="indeterminate" type="checkbox" id="__nav_6_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6_4">
          Testing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Testing" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_4">
          <span class="md-nav__icon md-icon"></span>
          Testing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/testing/" class="md-nav__link">
        Team Members
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/testing/release_criteria/" class="md-nav__link">
        Release Criteria
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_5" data-md-state="indeterminate" type="checkbox" id="__nav_6_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6_5">
          Design
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Design" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_5">
          <span class="md-nav__icon md-icon"></span>
          Design
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/design/" class="md-nav__link">
        Design
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" data-md-state="indeterminate" type="checkbox" id="__nav_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Rocky Linux
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Rocky Linux" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Rocky Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../rocky/" class="md-nav__link">
        Rocky Linux General Information
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../rocky/repo/" class="md-nav__link">
        Rocky Linux Repositories
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Archive
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Archive" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Archive
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        Archives
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_2" type="checkbox" id="__nav_8_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_8_2">
          Legacy
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Legacy" data-md-level="2">
        <label class="md-nav__title" for="__nav_8_2">
          <span class="md-nav__icon md-icon"></span>
          Legacy
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Legacy
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" data-md-state="indeterminate" type="checkbox" id="__nav_9" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Contributing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Contributing" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Contributing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/rosca/" class="md-nav__link">
        Rocky Open Source Contributor Agreement
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/start/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/rocky-linux/wiki.rockylinux.org/edit/main/docs/archive/legacy/koji_setup.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h1>
<p>This how-to is WIP and based on https://docs.pagure.org/koji/</p>
<p>The setup is as follows:
* CentOS-8 installed
* Firewall allowing communication between the hosts
* Public network for access and private network for koji and kerberos communication between hosts
* koji.gnulab.org/10.10.10.2 hosts koji, kojiweb, koji-hub,kojira, kerberos server, kerberos workstation "for testing"
* builder1.gnulab.org/10.10.10.3 hosts kojid building daemon and kerberos workstation "for testing"
* Your location machine should have kerberos workstation as well and a browser configured to use kerberos
* SSL is setup for web facing services using let's encrypt, you need to sort this one out</p>
<h1 id="getting-kerberos-up-and-running">Getting kerberos up and running<a class="headerlink" href="#getting-kerberos-up-and-running" title="Permanent link">&para;</a></h1>
<p>!!!THIS IS A QUICK GUIDE FOR TESTING ONLY!!!</p>
<p>You will need to install kerberos for this setup, however I assume IPA will be in place and will be used</p>
<p>On the koji.gnulab.org machine do the following:
* Install he needed packages:
<code>dnf install krb5-server.x86_64 krb5-workstation.x86_64 -y</code>
* Edit <strong>/etc/krb5.conf</strong> to look like that
<div class="highlight"><pre><span></span><code># To opt out of the system crypto-policies configuration of krb5, remove the
# symlink at /etc/krb5.conf.d/crypto-policies which will not be recreated.
includedir /etc/krb5.conf.d/

[logging]
    default = FILE:/var/log/krb5libs.log
    kdc = FILE:/var/log/krb5kdc.log
    admin_server = FILE:/var/log/kadmind.log

[libdefaults]
    dns_lookup_realm = false
    ticket_lifetime = 24h
    renew_lifetime = 7d
    forwardable = true
    rdns = false
    pkinit_anchors = FILE:/etc/pki/tls/certs/ca-bundle.crt
    spake_preauth_groups = edwards25519
    default_realm = GNULAB.ORG
    default_ccache_name = KEYRING:persistent:%{uid}

[realms]
 GNULAB.ORG = {
     kdc = koji.gnulab.org
     admin_server = koji.gnulab.org
 }

[domain_realm]
 .gnulab.org = GNULAB.ORG
 gnulab.org = GNULAB.ORG
</code></pre></div>
Where GNULAB.ORG is your realm
* Create kerberos DB and create your super secrete password for the DB:
<code>kdb5_util create -s</code>
* Edit kerberos ACL <strong>/var/kerberos/krb5kdc/kadm5.acl</strong> to look as follows:
<div class="highlight"><pre><span></span><code>*/admin@GNULAB.ORG  *
</code></pre></div>
* Create the local admin:
<code>kadmin.local -q "addprinc admin/admin"</code>
* Start you services:
<code>systemctl enable krb5kdc --now &amp;&amp; systemctl enable kadmin --now</code></p>
<h2 id="the-principles">The principles<a class="headerlink" href="#the-principles" title="Permanent link">&para;</a></h2>
<p>koji needs few principles in kerberos for authentication as follows:</p>
<ul>
<li>host/kojihub@GNULAB.ORG: Used by the koji-hub server when communicating with the koji client</li>
<li>HTTP/kojiweb@GNULAB.ORG: Used by the koji-web server when performing a negotiated Kerberos authentication with a web browser. This is a service principal for Apache’s mod_auth_gssapi.</li>
<li>koji/kojiweb@GNULAB.ORG: Used by the koji-web server during communications with the koji-hub. This is a user principal that will authenticate koji-web to Kerberos as “koji/kojiweb@GNULAB.ORG”. Koji-web will proxy the mod_auth_gssapi user information to koji-hub (the ProxyPrincipals koji-hub config option).</li>
<li>koji/kojira@GNULAB.ORG: Used by the kojira server during communications with the koji-hub</li>
<li>compile/builder1.gnulab.org@GNULAB.ORG: Used on builder1 to communicate with the koji-hub. This is a user principal that will authenticate koji-builder to Kerberos as “compile/builder1.gnulab.org@GNULAB.ORG”. Each builder host will have its own unique Kerberos user principal to authenticate to the hub.</li>
<li>snagy@GNULAB.ORG: for my testing and package owner</li>
<li>HTTP/koji.gnulab.org@GNULAB.ORG: to allow the client to use HTTP "I am not sure"</li>
</ul>
<p>And we can start creating the needed principles:
* run <code>kadmin.local</code> then the following:
<div class="highlight"><pre><span></span><code>addprinc host/kojihub@GNULAB.ORG
addprinc HTTP/kojiweb@GNULAB.ORG
addprinc koji/kojiweb@GNULAB.ORG
addprinc koji/kojira@GNULAB.ORG
addprinc HTTP/koji.gnulab.org@GNULAB.ORG
addprinc snagy@GNULAB.ORG
addprinc kojiadmin@GNULAB.ORG
</code></pre></div></p>
<ul>
<li>Now we will need to create keytab, keytab is used for non-password auth, also I guess once you do that, you won't be able to use passwords, but that is okay since most of those are services principals, not that you can use multiple files if you need to, run <code>kadmin.local</code> and then:
<div class="highlight"><pre><span></span><code>    ktadd   -k /etc/koji.keytab host/kojihub@GNULAB.ORG
    ktadd   -k /etc/koji.keytab HTTP/kojiweb@GNULAB.ORG
    ktadd   -k /etc/koji.keytab koji/kojira@GNULAB.ORG
    ktadd   -k /etc/koji.keytab koji/kojiweb@GNULAB.ORG
    ktadd   -k /etc/koji.keytab HTTP/koji.gnulab.org@GNULAB.ORG
</code></pre></div></li>
<li>Validation done by running <code>klist -k -t /etc/koji.keytab</code></li>
<li>Run change permissions: <code>chmod 644 /etc/koji.keytab</code>
<div class="highlight"><pre><span></span><code>root# klist -k -t /etc/koji.keytab
Keytab name: FILE:/etc/koji.keytab
KVNO Timestamp           Principal
---- ------------------- ------------------------------------------------------
   2 12/19/2020 15:00:53 koji/kojira@GNULAB.ORG
   2 12/19/2020 15:00:53 koji/kojira@GNULAB.ORG
   2 12/19/2020 15:01:08 koji/kojiweb@GNULAB.ORG
   2 12/19/2020 15:01:08 koji/kojiweb@GNULAB.ORG
   2 12/19/2020 15:01:14 HTTP/kojiweb@GNULAB.ORG
   2 12/19/2020 15:01:14 HTTP/kojiweb@GNULAB.ORG
   2 12/19/2020 15:01:20 host/kojihub@GNULAB.ORG
   2 12/19/2020 15:01:20 host/kojihub@GNULAB.ORG
   2 12/19/2020 15:38:52 HTTP/koji.gnulab.org@GNULAB.ORG
   2 12/19/2020 15:38:52 HTTP/koji.gnulab.org@GNULAB.ORG
</code></pre></div></li>
</ul>
<h1 id="setting-up-koji-echosystem">Setting up koji echosystem<a class="headerlink" href="#setting-up-koji-echosystem" title="Permanent link">&para;</a></h1>
<p>We will start by setting up the DB, koji-hub, kojiweb and then kojira</p>
<h2 id="the-database">The Database<a class="headerlink" href="#the-database" title="Permanent link">&para;</a></h2>
<p>On the main server koji.gnulab.org, do the following:
* We need to install postgreqsl: <code>dnf install postgresql-server -y</code>
* Init postgresql db: <code>postgresql-setup --initdb --unit postgresql</code>
* Start the service: <code>systemctl enable postgresql --now</code>
* Adding Koji user:
<div class="highlight"><pre><span></span><code>useradd koji
passwd koji
</code></pre></div>
and set a random complex password
* Lets create koji DB user:
<div class="highlight"><pre><span></span><code>su - postgres
createuser --no-superuser --no-createrole --no-createdb koji
createdb -O koji koji
psql -c &quot;alter user koji with encrypted password &#39;mysupercomplexpassword&#39;;&quot;
</code></pre></div>
* Let's setup koji: <code>dnf install koji -y</code>
* load the DB into postgresql:
    <code>su - koji
  psql koji koji &lt; /usr/share/doc/koji*/docs/schema.sql</code>
* Postgresql permissions
Since my koji server lives with the postgresql, I am using socket communication instead of TCP/IP
* Edit <strong>/var/lib/pgsql/data/pg_hba.conf</strong> as follows "Order is important":
<div class="highlight"><pre><span></span><code># &quot;local&quot; is for Unix domain socket connections only
local   koji        koji                    trust
local   all             all                                     peer
</code></pre></div>
* Reload postgresql: <code>systemctl reload postgresql</code>
* Create koji authenticiation for kerberos:
<div class="highlight"><pre><span></span><code>su - koji

psql &lt;&lt;EOF
with user_id as (
insert into users (name, status, usertype) values (&#39;kojiadmin&#39;, 0, 0) returning id
)
insert into user_krb_principals (user_id, krb_principal) values (
(select id from user_id),
&#39;kojiadmin@GNULAB.ORG&#39;);
EOF
</code></pre></div>
* Give the user admin permissions:
<div class="highlight"><pre><span></span><code>    su - koji
    psql
    koji=&gt; select * from users;
    koji=&gt; insert into user_perms (user_id, perm_id, creator_id) values (&quot;id of user inserted above&quot;, 1, &quot;id of user inserted above&quot;);
</code></pre></div></p>
<h2 id="mntkoji-and-nfs">/mnt/koji and NFS<a class="headerlink" href="#mntkoji-and-nfs" title="Permanent link">&para;</a></h2>
<ul>
<li>Create the koji file system skeleton:</li>
<li>Setup NFS and apache : <code>dnf install nfs-utils httpd -y</code>
<div class="highlight"><pre><span></span><code>cd /mnt
mkdir koji
cd koji
mkdir {packages,repos,work,scratch,repos-dist}
chown apache.apache *
</code></pre></div></li>
<li>Start the service: <code>systemctl enable --now nfs-server</code></li>
<li>Edit <strong>/etc/exports</strong> as follows:
<div class="highlight"><pre><span></span><code>/mnt/koji 10.10.10.3(ro,sync,no_all_squash,root_squash)
</code></pre></div></li>
<li>Export the filesystem: <code>exportfs -ra</code></li>
<li>View current state: <code>exportfs -v</code></li>
<li>On the client install the NFS client packages: <code>dnf install nfs-utils nfs4-acl-tools -y</code></li>
<li>Create the local dir: <code>mkdir /mnt/koji</code></li>
<li>Mount the NFS: <code>mount -t nfs 10.10.10.2:/mnt/koji /mnt/koji</code></li>
</ul>
<h2 id="kojihub">Kojihub<a class="headerlink" href="#kojihub" title="Permanent link">&para;</a></h2>
<ul>
<li>Install kojihub <code>dnf install koji-hub mod_ssl -y</code></li>
<li>Enable postgresql sweep function: <code>systemctl enable --now koji-sweep-db.timer</code></li>
<li>Enable kerberos auth in <strong>/etc/httpd/conf.d/kojihub.conf</strong> by uncomment the section below as follows:
<div class="highlight"><pre><span></span><code># uncomment this to enable authentication via GSSAPI
 &lt;Location /kojihub/ssllogin&gt;
         AuthType GSSAPI
         AuthName &quot;GSSAPI Single Sign On Login&quot;
         GssapiCredStore keytab:/etc/koji.keytab
         Require valid-user
 &lt;/Location&gt;
</code></pre></div></li>
<li>koji-hub configurations as follows in <strong>/etc/koji-hub/hub.conf</strong>:
<div class="highlight"><pre><span></span><code>[hub]

DBName = koji
DBUser = koji
KojiDir = /mnt/koji
AuthPrincipal = host/kojihub@GNULAB.ORG
AuthKeytab = /etc/koji.keytab
ProxyPrincipals = koji/kojiweb@GNULAB.ORG
HostPrincipalFormat = compile/%s@GNULAB.ORG
LoginCreatesUser = On
KojiWebURL = https://koji.gnulab.org/koji
NotifyOnSuccess = True
</code></pre></div></li>
<li>Install selinux policyutils: <code>dnf install policycoreutils-python-utils -y</code></li>
<li>Lets fix some selinux stuff:
<div class="highlight"><pre><span></span><code>    setsebool -P allow_httpd_anon_write=1
    setsebool -P httpd_can_network_connect 1
    setsebool -P httpd_use_nfs=1
    semanage fcontext -a -t public_content_rw_t &quot;/mnt/koji(/.*)?&quot;
    restorecon -r -v /mnt/koji
  ```
## Configure koji cli client
* edit **/etc/koji.conf** as follows:
</code></pre></div>
[koji]</li>
</ul>
<p>server = https://koji.gnulab.org/kojihub
weburl = https://koji.gnulab.org/koji
topurl = https://koji.gnulab.org/
topdir = /mnt/koji
authtype = kerberos
krb_rdns = false
plugins = runroot
use_fast_upload = yes
<div class="highlight"><pre><span></span><code>* restart httpd: ```systemctl restart httpd```
* Test by running the following on koji server:
    * kinit -p kojiadmin@GNULAB.ORG
    * koji moshimoshi
</code></pre></div>
[root@koji ~]# kinit -p kojiadmin@GNULAB.ORG
Password for kojiadmin@GNULAB.ORG:
[root@koji ~]# koji moshimoshi
hylô, kojiadmin!</p>
<p>You are using the hub at https://koji.gnulab.org/kojihub
Authenticated via GSSAPI
<div class="highlight"><pre><span></span><code>## Kojiweb
* Install kojiweb: ```dnf install koji-web -y```
* Edit **/etc/httpd/conf.d/kojiweb.conf** to allow kerberos:
</code></pre></div></p>
<h1 id="uncomment-this-to-enable-authentication-via-kerberos">uncomment this to enable authentication via Kerberos<a class="headerlink" href="#uncomment-this-to-enable-authentication-via-kerberos" title="Permanent link">&para;</a></h1>
<p><Location /koji/login>
     AuthType GSSAPI
     AuthName "Koji Web UI"
     GssapiCredStore keytab:/etc/koji.keytab
     Require valid-user
     ErrorDocument 401 /koji-static/errors/unauthorized.html
 </Location></p>
<p><div class="highlight"><pre><span></span><code>* Edit Kojiweb configuration **/etc/kojiweb/web.conf**
</code></pre></div>
[web]
SiteName = koji</p>
<p>KojiHubURL = https://koji.gnulab.org/kojihub
KojiFilesURL = https://koji.gnulab.org/kojifiles</p>
<p>WebPrincipal = koji/kojiweb@GNULAB.ORG
WebKeytab = /etc/koji.keytab
WebCCache = /var/tmp/kojiweb.ccache
KrbService = koji.gnulab.org
KrbServerRealm = GNULAB.ORG
LoginTimeout = 72
Secret = asdasdf12313ewdasfq234f
LibPath = /usr/share/koji-web/lib
LiteralFooter = True
<div class="highlight"><pre><span></span><code>* restart apache: ```systemctl reload httpd```
## Setting up the builder / kojid / koji-builder
This will configuration will be on the building node(s)

* Install koji-builder: ```dnf install koji-builder -y```
* Edit **/etc/kojid/kojid.conf** as follows:
</code></pre></div>
[kojid]</p>
<p>topdir=/mnt/koji
workdir=/tmp/koji
server=https://koji.gnulab.org/kojihub
topurl=https://koji.gnulab.org/kojifiles
; those are for building package from git.c.o and Mustafa's git
allowed_scms=git.centos.org:/<em>:off:get_sources.sh gitlab.rockylinux.bycrates.org:/</em>:off:/bin/sh,/usr/bin/srpmproc_wrapper
host_principal_format=compile/%s@GNULAB.ORG
<div class="highlight"><pre><span></span><code>On koji main server, run the following commands:
* Add the new builder:  ```koji add-host builder1.gnulab.org  x86_64```
* Add the createrepo channel: ```koji add-host-to-channel builder1.gnulab.org createrepo```
* I did adjust the capacity since it is a small machine: ```koji edit-host --capacity=8 builder1.gnulab.org```
* Note, by default kojid uses DNS to talk to koji-hub, so you need to have SRV record in your DNS as follows:
</code></pre></div>
_kerberos._udp    IN SRV  10 100 88 kerberos.GNULAB.ORG.
<div class="highlight"><pre><span></span><code>* Kojid looks for **/etc/kojid/kojid.keytab** by default, so you need to create a file with compile principle as above and place it in the right location on builder node(s)
</code></pre></div>
kadmin.local
addprinc compile/builder1.gnulab.org@GNULAB.ORG
ktadd -k /tmp/kojid.keytab compile/builder1.gnulab.org@GNULAB.ORG
<div class="highlight"><pre><span></span><code>On the builder node, restart kojid: ```systemctl enable kojid --now```

## Kojira

* Install koji-utils: ```dnf install koji-utils -y```
* Add kojira user and give it permission for repo
</code></pre></div>
koji add-user koji/kojira
koji grant-permission repo koji/kojira
<div class="highlight"><pre><span></span><code>* Edit **/etc/kojira/kojira.conf** as following:
</code></pre></div>
[kojira]</p>
<p>server=https://koji.gnulab.org/kojihub
topdir=/mnt/koji
logfile=/var/log/kojira.log
principal = koji/kojira@GNULAB.ORG
keytab = /etc/koji.keytab
<div class="highlight"><pre><span></span><code>* Start Kojira service: ```systemctl enable kojira --now```

# Koji bootstrapping

I went with the external repo method to bootstrap the setup, so I added external repos and create the following tags and targets, this work is based on: https://docs.pagure.org/koji/external_repo_server_bootstrap/

On the main node, run the following:
* Add your final dist tag: ```koji add-tag dist-rocky8```
* Create the build tag:
```koji add-tag --parent dist-rocky8 --arches &quot;x86_64&quot; -x mock.yum.module_hotfixes=1 dist-rocky8-build```

* Add the external repos, I hard coded the ARCH, but you can use \$arch instaed of x86_64 in the repo URL:
</code></pre></div>
koji add-external-repo -m bare -t dist-rocky8-build centos-8-baseos-external http://mirror.centos.org/centos-8/8.3.2011/BaseOS/\$arch/os/
koji add-external-repo -m bare -t dist-rocky8-build centos-8-appstream-external http://mirror.centos.org/centos-8/8.3.2011/AppStream/\$arch/os/
koji add-external-repo -m bare -t dist-rocky8-build centos-8-devel-external http://mirror.centos.org/centos-8/8.3.2011/Devel/\$arch/os/
koji add-external-repo -m bare -t dist-rocky8-build centos-8-ha-external http://mirror.centos.org/centos-8/8.3.2011/HighAvailability/\$arch/os/
koji add-external-repo -m bare -t dist-rocky8-build centos-8-pt-external http://mirror.centos.org/centos-8/8.3.2011/PowerTools/\$arch/os/
koji add-external-repo -m bare -t dist-rocky8-build centos-8-cp-external http://mirror.centos.org/centos-8/8.3.2011/centosplus/\$arch/os/
koji add-external-repo -m bare -t dist-rocky8-build centos-8-cr-external http://mirror.centos.org/centos-8/8.3.2011/cr/\$arch/os/
koji add-external-repo -m bare -t dist-rocky8-build centos-8-extras-external http://mirror.centos.org/centos-8/8.3.2011/extras/\$arch/os/
koji add-external-repo -m bare -t dist-rocky8-build centos-8-fasttrack-external http://mirror.centos.org/centos-8/8.3.2011/fasttrack/\$arch/os
koji add-external-repo -m bare -t dist-rocky8-build centos-8-debuginfo-external http://debuginfo.centos.org/8/\$arch/
<div class="highlight"><pre><span></span><code>* I also created a small package for centospkg-minimal and srpmproc and create local repo, so adding that too: 
</code></pre></div>
koji add-external-repo -m bare -t dist-rocky8-build centos-8-local-repo-external https://koji.gnulab.org/localrepo/\$arch/
<div class="highlight"><pre><span></span><code>* Add the targets: ```koji add-target dist-rocky8 dist-rocky8-build dist-rocky8```
* Create the bootstrapping groups for build and srpm-build
</code></pre></div>
koji add-group dist-rocky8-build build
koji add-group dist-rocky8-build srpm-build
<div class="highlight"><pre><span></span><code>* Add the bootstrapping packages:
</code></pre></div>
koji add-group-pkg dist-rocky8-build build bash buildsys-macros-el8 bzip2 centos-release centpkg-minimal coreutils cpio diffutils findutils gawk gcc gcc-c++ grep gzip info make module-build-macros patch redhat-rpm-config rpm-build scl-utils-build sed shadow-utils tar unzip util-linux which xz git srpmproc
koji add-group-pkg dist-rocky8-build srpm-build bash buildsys-macros-el8 centos-release centpkg-minimal git redhat-rpm-config rpm-build scl-utils-build shadow-utils system-release srpmproc
<div class="highlight"><pre><span></span><code>* Regenerating the repos ```koji regen-repo dist-rocky8-build```

# Running a test

I ran the following test to build package from git.centos.org:

```koji add-user snagy```
```koji add-pkg --owner snagy dist-rocky8 python36``` &quot;need to check if this is needed&quot;
</code></pre></div>
koji build dist-rocky8 'git+https://git.centos.org/git/rpms/python36.git?#f900ab6403fbd9c22e59f5d463fee210b3278fb3'
```
*  Results at: https://koji.gnulab.org/koji/taskinfo?taskID=321</p>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../koji_bootstrap/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Koji Bootstrap (setup)" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Koji Bootstrap (setup)
            </div>
          </div>
        </a>
      
      
        
        <a href="../mbs_installation/" class="md-footer__link md-footer__link--next" aria-label="Next: Module-build-service &#34;mbs&#34; setup" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Module-build-service "mbs" setup
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021 Rocky Enterprise Software Foundation
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["toc.integrate", "search.suggest", "search.highlight", "navigation.top", "navigation.tabs", "navigation.expand"], "search": "../../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.748e2769.min.js"></script>
      
    
  </body>
</html>